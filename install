#!/usr/bin/env bash

function help(){
cat<<HELP
install gitconfig file with updated name and email
Usage: $(basename $0) [options]
            Without options the installation is interactive
Options:
    -n/--name     : Name of the commiter
    -e/--email    : Email of the commiter
HELP
}

NAME=""
EMAIL=""
if [[ $# -eq 0 ]];then
    echo "What is your name?"
    read NAME
    echo "What is your email address?"
    read EMAIL
fi

while [[ $# -gt 0 ]];do
    key="$1"

    case ${key} in
        -n|--name)
            shift
            NAME=$1
            shift
            ;;
        -e|--email)
            shift
            EMAIL=$1
            shift
            ;;
        *)
            help
            exit 1;
            ;;
    esac
done

echo "Using name: $NAME and email $EMAIL"

cat ./gitconfig | sed "s/NAME/$NAME/" > .gitconfig
sed -i "s/EMAIL/$EMAIL/" ./.gitconfig
if [ -e $HOME/.gitconfig ]; then
    mv $HOME/.gitconfig $HOME/.gitconfig_bak
    if [ $? -eq 0 ];then
        echo "Existing .gitconfig backed up to $HOME/.gitconfig_bak"
    else
        exit 1
fi

fi
mv .gitconfig $HOME/.gitconfig
exit $?

